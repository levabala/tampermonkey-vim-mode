<!doctype html>
<html>
    <head>
        <title>Test Visual Mode</title>
        <style>
            :root {
                --bg-color: #ffffff;
                --text-color: #000000;
                --border-color: blue;
                --instructions-bg: #f0f0f0;
                --textarea-bg: #ffffff;
                --textarea-text: #000000;
            }

            @media (prefers-color-scheme: dark) {
                :root {
                    --bg-color: #1e1e1e;
                    --text-color: #e0e0e0;
                    --border-color: #4a9eff;
                    --instructions-bg: #2d2d2d;
                    --textarea-bg: #252525;
                    --textarea-text: #e0e0e0;
                }
            }

            [data-theme="dark"] {
                --bg-color: #1e1e1e;
                --text-color: #e0e0e0;
                --border-color: #4a9eff;
                --instructions-bg: #2d2d2d;
                --textarea-bg: #252525;
                --textarea-text: #e0e0e0;
            }

            [data-theme="light"] {
                --bg-color: #ffffff;
                --text-color: #000000;
                --border-color: blue;
                --instructions-bg: #f0f0f0;
                --textarea-bg: #ffffff;
                --textarea-text: #000000;
            }

            body {
                font-family: monospace;
                padding: 20px;
                height: 3000px; /* Force window scroll */
                background-color: var(--bg-color);
                color: var(--text-color);
                transition:
                    background-color 0.3s,
                    color 0.3s;
            }
            .container {
                height: 6000px; /* Large container to enable window scrolling */
                border: 2px solid var(--border-color);
                padding: 10px;
                margin-bottom: 50px;
            }
            textarea {
                width: 800px;
                height: 1500px; /* Force internal textarea scroll */
                font-size: 16px;
                font-family: monospace;
                padding: 10px;
                overflow: auto;
                background-color: var(--textarea-bg);
                color: var(--textarea-text);
                border: 1px solid var(--border-color);
                transition:
                    background-color 0.3s,
                    color 0.3s;
            }
            textarea.small {
                height: 100px; /* Small textarea with few lines */
            }
            .instructions {
                background: var(--instructions-bg);
                padding: 15px;
                margin-bottom: 20px;
                border-radius: 4px;
                transition: background-color 0.3s;
            }
            .theme-toggle {
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 10px 15px;
                background: var(--instructions-bg);
                border: 1px solid var(--border-color);
                border-radius: 4px;
                cursor: pointer;
                font-family: monospace;
                color: var(--text-color);
                transition: all 0.3s;
            }
            .theme-toggle:hover {
                opacity: 0.8;
            }
            kbd {
                background: var(--instructions-bg);
                border: 1px solid var(--border-color);
                border-radius: 3px;
                padding: 2px 5px;
                font-family: monospace;
            }
        </style>
    </head>
    <body>
        <button class="theme-toggle" onclick="toggleTheme()">
            ðŸŒ“ Toggle Theme
        </button>
        <div class="instructions">
            <h2>Test Visual Mode Selection</h2>
            <ol>
                <li>Click in the textarea below</li>
                <li>Press <kbd>ESC</kbd> to enter normal mode</li>
                <li>
                    Move cursor to middle of line (e.g., press <kbd>5l</kbd>)
                </li>
                <li>Press <kbd>v</kbd> to enter visual mode</li>
                <li>
                    Move with <kbd>h</kbd>, <kbd>j</kbd>, <kbd>k</kbd>,
                    <kbd>l</kbd> or <kbd>w</kbd>, <kbd>b</kbd>
                </li>
                <li>
                    You should see a
                    <strong>white semi-transparent overlay</strong> highlighting
                    the selection from where you pressed <kbd>v</kbd>
                </li>
                <li>
                    Press <kbd>y</kbd> to yank (copy), <kbd>d</kbd> to delete,
                    or <kbd>c</kbd> to change
                </li>
            </ol>
            <h3>Test Text Objects</h3>
            <ul>
                <li><kbd>di(</kbd> - delete inside parentheses</li>
                <li>
                    <kbd>da(</kbd> - delete around parentheses (including
                    parens)
                </li>
                <li><kbd>ci{</kbd> - change inside braces</li>
                <li><kbd>yi"</kbd> - yank inside quotes</li>
                <li><kbd>vi)</kbd> - visual select inside parentheses</li>
                <li>Works with: (), [], {}, &lt;&gt;, "", '', ``</li>
            </ul>
            <p>
                <strong>Debug:</strong> Open DevTools Console and add
                <code>?VIM_DEBUG=1</code> to URL to see debug logs
            </p>
        </div>

        <h3>Small Textarea (5 lines or less - no line numbers)</h3>
        <textarea id="small-textarea" class="small">
Line 1
Line 2
Line 3
Line 4
Line 5</textarea
        >

        <h3>Large Textarea (line numbers should appear)</h3>
        <div class="container">
            <textarea id="large-textarea">
TEXT OBJECTS TEST EXAMPLES:
Simple: foo(bar)baz and [hello] and {world} and <test> and "quotes" and 'single' and `backticks`
Multiword: test(hello world there)end and [multiple words here] and {many words inside}after
Nested: outer(inner(deep content))end
Mixed: "text with (parens inside)" and {array[1, 2, 3]} test

Multiline example (put cursor inside and try di( or da():
function example(param one, param two,
  param three, param four) {
  return result;
}

Try these commands (put cursor INSIDE the pair first):
- di( or di) - delete inside parentheses
- da( or da) - delete around parentheses (including the parens)
- ci{ or ci} - change inside braces (deletes and enters insert mode)
- yi" - yank inside quotes (then press p to paste)
- vi[ - visual select inside brackets (then d to delete)
Works with: (), [], {}, <>, "", '', ``

Line 1: The quick brown fox jumps over the lazy dog and continues running across the meadow with tremendous speed and agility while being chased by the farmer
Line 2: jumps over the lazy dog
Line 3: Lorem ipsum dolor sit amet consectetur adipiscing elit sed do eiusmod tempor incididunt ut labore et dolore magna aliqua ut enim ad minim veniam quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat duis aute irure dolor in reprehenderit
Line 4: consectetur adipiscing elit
Line 5: sed do eiusmod tempor
Line 6: incididunt ut labore et dolore
Line 7: magna aliqua. Ut enim ad minim
Line 8: veniam, quis nostrud exercitation
Line 9: ullamco laboris nisi ut aliquip
Line 10: ex ea commodo consequat
Line 11: Duis aute irure dolor in reprehenderit
Line 12: in voluptate velit esse cillum
Line 13: dolore eu fugiat nulla pariatur
Line 14: Excepteur sint occaecat cupidatat
Line 15: non proident, sunt in culpa qui
Line 16: officia deserunt mollit anim id
Line 17: est laborum. Sed ut perspiciatis
Line 18: unde omnis iste natus error sit
Line 19: voluptatem accusantium doloremque
Line 20: laudantium, totam rem aperiam
Line 21: eaque ipsa quae ab illo inventore
Line 22: veritatis et quasi architecto
Line 23: beatae vitae dicta sunt explicabo
Line 24: Nemo enim ipsam voluptatem quia
Line 25: voluptas sit aspernatur aut odit
Line 26: aut fugit, sed quia consequuntur
Line 27: magni dolores eos qui ratione
Line 28: voluptatem sequi nesciunt. Neque
Line 29: porro quisquam est, qui dolorem
Line 30: ipsum quia dolor sit amet
Line 31: consectetur, adipisci velit, sed
Line 32: quia non numquam eius modi tempora
Line 33: incidunt ut labore et dolore
Line 34: magnam aliquam quaerat voluptatem
Line 35: Ut enim ad minima veniam, quis
Line 36: nostrum exercitationem ullam corporis
Line 37: suscipit laboriosam, nisi ut aliquid
Line 38: ex ea commodi consequatur? Quis
Line 39: autem vel eum iure reprehenderit
Line 40: qui in ea voluptate velit esse
Line 41: quam nihil molestiae consequatur
Line 42: vel illum qui dolorem eum fugiat
Line 43: quo voluptas nulla pariatur
Line 44: At vero eos et accusamus et iusto
Line 45: odio dignissimos ducimus qui blanditiis
Line 46: praesentium voluptatum deleniti atque
Line 47: corrupti quos dolores et quas
Line 48: molestias excepturi sint occaecati
Line 49: cupiditate non provident, similique
Line 50: sunt in culpa qui officia deserunt
Line 51: mollitia animi, id est laborum
Line 52: et dolorum fuga. Et harum quidem
Line 53: rerum facilis est et expedita
Line 54: distinctio. Nam libero tempore
Line 55: cum soluta nobis est eligendi
Line 56: optio cumque nihil impedit quo
Line 57: minus id quod maxime placeat facere
Line 58: possimus, omnis voluptas assumenda
Line 59: est, omnis dolor repellendus
Line 60: Temporibus autem quibusdam et aut
Line 61: officiis debitis aut rerum necessitatibus
Line 62: saepe eveniet ut et voluptates
Line 63: repudiandae sint et molestiae non
Line 64: recusandae. Itaque earum rerum hic
Line 65: tenetur a sapiente delectus, ut
Line 66: aut reiciendis voluptatibus maiores
Line 67: alias consequatur aut perferendis
Line 68: doloribus asperiores repellat
Line 69: Lorem ipsum dolor sit amet again
Line 70: consectetur adipiscing elit again
Line 71: sed do eiusmod tempor incididunt
Line 72: ut labore et dolore magna aliqua
Line 73: Ut enim ad minim veniam, quis
Line 74: nostrud exercitation ullamco laboris
Line 75: nisi ut aliquip ex ea commodo
Line 76: consequat. Duis aute irure dolor
Line 77: in reprehenderit in voluptate velit
Line 78: esse cillum dolore eu fugiat nulla
Line 79: pariatur. Excepteur sint occaecat
Line 80: cupidatat non proident, sunt in
Line 81: culpa qui officia deserunt mollit
Line 82: anim id est laborum. Sed ut
Line 83: perspiciatis unde omnis iste natus
Line 84: error sit voluptatem accusantium
Line 85: doloremque laudantium, totam rem
Line 86: aperiam, eaque ipsa quae ab illo
Line 87: inventore veritatis et quasi
Line 88: architecto beatae vitae dicta sunt
Line 89: explicabo. Nemo enim ipsam
Line 90: voluptatem quia voluptas sit
Line 91: aspernatur aut odit aut fugit
Line 92: sed quia consequuntur magni dolores
Line 93: eos qui ratione voluptatem sequi
Line 94: nesciunt. Neque porro quisquam est
Line 95: qui dolorem ipsum quia dolor sit
Line 96: amet, consectetur, adipisci velit
Line 97: sed quia non numquam eius modi
Line 98: tempora incidunt ut labore et
Line 99: dolore magnam aliquam quaerat
Line 100: voluptatem. Ut enim ad minima
Line 101: veniam, quis nostrum exercitationem
Line 102: ullam corporis suscipit laboriosam
Line 103: nisi ut aliquid ex ea commodi
Line 104: consequatur? Quis autem vel eum
Line 105: iure reprehenderit qui in ea
Line 106: voluptate velit esse quam nihil
Line 107: molestiae consequatur, vel illum
Line 108: qui dolorem eum fugiat quo
Line 109: voluptas nulla pariatur? At vero
Line 110: eos et accusamus et iusto odio
Line 111: dignissimos ducimus qui blanditiis
Line 112: praesentium voluptatum deleniti
Line 113: atque corrupti quos dolores et
Line 114: quas molestias excepturi sint
Line 115: occaecati cupiditate non provident
Line 116: similique sunt in culpa qui
Line 117: officia deserunt mollitia animi
Line 118: id est laborum et dolorum fuga
Line 119: Et harum quidem rerum facilis est
Line 120: et expedita distinctio final line

Test visual mode and scrolling:
- Try selecting across lines
- Try visual line mode with V
- Check if blue overlay appears
- Test scrolling with Ctrl-e (down), Ctrl-y (up)
- Test scrolling with Ctrl-d (half page down), Ctrl-u (half page up)
- Scrolling should work in INSERT and NORMAL modes!</textarea
            >
        </div>

        <h3>
            Performance Test Textarea (1500 lines for j/k performance testing)
        </h3>
        <textarea id="performance-textarea" rows="30" cols="80"></textarea>
        <script>
            // Generate 1500 lines for performance testing (10x from original 150)
            // 10% of lines should be long enough to wrap
            const perfLines = [];
            for (let i = 1; i <= 1500; i++) {
                if (i % 10 === 0) {
                    // Every 10th line is extra long to cause wrapping (3x longer than before)
                    perfLines.push(
                        `Line ${i}: This is a very long test line with lots of content that should wrap around when displayed in the textarea because it exceeds the visible width. Lorem ipsum dolor sit amet consectetur adipiscing elit sed do eiusmod tempor incididunt ut labore et dolore magna aliqua ut enim ad minim veniam quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur excepteur sint occaecat cupidatat non proident sunt in culpa qui officia deserunt mollit anim id est laborum sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium totam rem aperiam eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.`,
                    );
                } else {
                    perfLines.push(
                        `Line ${i}: This is a test line with some content to make it realistic. Lorem ipsum dolor sit amet.`,
                    );
                }
            }
            document.getElementById("performance-textarea").value =
                perfLines.join("\n");
        </script>

        <script>
            function toggleTheme() {
                const html = document.documentElement;
                const currentTheme = html.getAttribute("data-theme");
                const newTheme = currentTheme === "dark" ? "light" : "dark";
                html.setAttribute("data-theme", newTheme);
                localStorage.setItem("theme", newTheme);
            }

            // Load saved theme or use system preference
            (function () {
                const savedTheme = localStorage.getItem("theme");
                if (savedTheme) {
                    document.documentElement.setAttribute(
                        "data-theme",
                        savedTheme,
                    );
                } else if (
                    window.matchMedia("(prefers-color-scheme: dark)").matches
                ) {
                    document.documentElement.setAttribute("data-theme", "dark");
                }
            })();
        </script>
        <script src="dist/tampermonkey_vim_mode.js"></script>
    </body>
</html>
